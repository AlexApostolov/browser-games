<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Monster Smash</title>
</head>

<body>
  <canvas width="128" height="128"></canvas>
  <script>
    var monster = {
      // Use a single png to animate the monster.
      IMAGE: '../images/frames.png',
      SIZE: 128,

      // The number of animation frames starting from 0 index & the starting frame
      numberOfFrames: 5,
      currentFrame: 0,

      // Properties of the animation cell's x & y positions on the spritesheet. Init at 0.
      sourceX: 0,
      sourceY: 0,

      // Animation method for monster
      updateAnimation: function () {
        // Use currentFrame to find the correct section of the spritesheet to display
        this.sourceX = this.currentFrame * this.SIZE;
        this.sourceY = 0;

        // Increase currentFrame by 1 if it's no greater than the total # of frames
        if (this.currentFrame < this.numberOfFrames) {
          this.currentFrame++;
        }
      }
    };
    // Get a reference to the canvas
    var canvas = document.querySelector('canvas');
    // Get a reference to the canvas's drawing surface
    var drawingSurface = canvas.getContext('2d');
    // Hold the animation spritesheet in a created invisible <img>. You can now load and access any image using this variable.
    var image = new Image();
    // Add a listener to the image to call the render function when the image has finished loaded.
    // This is needed to solve a technical issue. The image won't load instantly; 
    // it takes a few milliseconds for the program to load it, and we don't want the rest of the program to continue to run without a visible image.
    image.addEventListener('load', loadHandler, false);
    // Assign the image's src property to the image you want to load. This image will be overwritten by monsterStates.png
    image.src = monster.IMAGE;

    function loadHandler() {
      // Start the animation
      updateAnimation();
    }

    function updateAnimation() {
      // Set a timer to call itself every 300 milliseconds, i.e. recursion.
      setTimeout(updateAnimation, 300);
      // Update the monster's animation frames
      monster.updateAnimation();
      // Render the animation
      render();
    }

    function render() {
      // It's always important to clear the canvas first when you're doing animation so that any images from the previous frames aren't displayed.
      // Clear the entire canvas of any previous frames with the clearRect method.
      drawingSurface.clearRect(0, 0, canvas.width, canvas.height);

      // Draw the monster's current animation frame.
      drawingSurface.drawImage(
        image,
        monster.sourceX, monster.sourceY, monster.SIZE, monster.SIZE,
        0, 0, monster.SIZE, monster.SIZE
      );
    };
  </script>
</body>

</html>