<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Monster Smash</title>
</head>

<body>
  <canvas width="64" height="64"></canvas>
  <script>
    var monster = {
      // Use a single png to alternate between two monster states
      image: '../images/monsterStates.png',
      // The monster's states
      NORMAL: 0,
      SCARED: 1,

      // Set its initial state
      state: 0
    };
    // Get a reference to the canvas
    var canvas = document.querySelector('canvas');
    // Get a reference to the canvas's drawing surface
    var drawingSurface = canvas.getContext('2d');
    // Hold the monsterImage in a created invisible <img>. You can now load and access any image using this variable.
    var monsterImage = new Image();
    // Add a listener to the image to call the render function when the image has finished loaded.
    // This is needed to solve a technical issue. The image won't load instantly; 
    // it takes a few milliseconds for the program to load it, and we don't want the rest of the program to continue to run without a visible image.
    monsterImage.addEventListener('load', render, false);
    // Assign the image's src property to the image you want to load. This image will be overwritten by monsterStates.png
    monsterImage.src = monster.image;

    // Change the monster's state by pressing and releasing a key
    window.addEventListener('keydown', keydownHandler, false);

    function keydownHandler(event) {
      // When a key is pressed, change the monster's state to SCARED and render it.
      becomeScared();
    }

    function becomeScared() {
      monster.state = monster.SCARED;
      setTimeout(becomeNormal, 1000);
      render();
    }

    function becomeNormal() {
      monster.state = monster.NORMAL;
      render();
    }

    function render() {
      // Render the correct state using drawImage() to selectively display the correct section of the image depending on monster's state.

      /* Instead of using the switch statement above, we can use math to move the x position 
      since both monster state images are the same size of 64 pixels and the canvas x position matches. 
      To get NORMAL state of 0, multiple 0 by 64 and it'll set x to 0, 
      to get SCARED state of 1, multiply 1 by 64 to get x position of 64 on the canvas. 
      The added benefit is that additional states can be added in the future without having to change the code! */
      drawingSurface.drawImage(
        monsterImage,
        64 * monster.state, 0, 64, 64,
        0, 0, 64, 64
      );
    };
  </script>
</body>

</html>